% !TEX program = pdflatex
%-------------------------
% Professional Cover Letter Template in LaTeX
% Author : iggymiggy

% License : MIT
%
% This template creates a professional cover letter that matches the
% styling of the cv_template.tex. All personal and company information
% is loaded from personal_info.tex for easy maintenance.
%
% Features:
%   - Automatic date formatting (Finnish/English)
%   - Consistent styling with CV template
%   - Easy customization of sections
%
% Usage:
%   1. Edit personal_info.tex with your information
%   2. Update company details in personal_info.tex
%   3. Replace TODO sections with your cover letter content
%   4. Compile with: pdflatex cover_letter_template.tex
%------------------------

\documentclass[letterpaper,11pt]{article}

\usepackage{latexsym}
\usepackage[empty]{fullpage}
\usepackage{titlesec}
\usepackage{marvosym}
\usepackage[usenames,dvipsnames]{color}
\usepackage{xcolor}
\usepackage{verbatim}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage[hidelinks]{hyperref}
\usepackage{fancyhdr}
\usepackage[finnish,english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{tabularx}
\usepackage{fontawesome5}  % Added for font awesome icons (LinkedIn and GitHub icons)
% \input{glyphtounicode}  % Commented out - \pdfgentounicode=1 below already handles Unicode encoding

\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields
\fancyfoot{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% Adjust margins
\addtolength{\oddsidemargin}{-0.5in}
\addtolength{\evensidemargin}{-0.5in}
\addtolength{\textwidth}{1in}
\addtolength{\topmargin}{-.5in}
\addtolength{\textheight}{1.0in}

\urlstyle{same}

\raggedbottom
\raggedright
\setlength{\tabcolsep}{0in}

% Sections formatting
\titleformat{\section}{
  \vspace{-4pt}\scshape\raggedright\large
}{}{0em}{}[\color{black}\titlerule \vspace{-5pt}]

% Ensure that generate PDF is machine readable/ATS parsable
\pdfgentounicode=1

%-------------------------
% Custom commands
\newcommand{\resumeItem}[2]{
  \item\small{
    \textbf{#1}{: #2 \vspace{-2pt}}
  }
}

\newcommand{\resumeItemSimple}[2]{
  \item\small{
    #2 \vspace{-2pt}
  }
}

% Just in case someone needs a heading that does not need to be in a list
\newcommand{\resumeHeading}[4]{
    \begin{tabular*}{0.99\textwidth}[t]{l@{\extracolsep{\fill}}r}
      \textbf{#1} & #2 \\
      \textit{\small#3} & \textit{\small #4} \\
    \end{tabular*}\vspace{-5pt}
}

\newcommand{\resumeSubheading}[4]{
  \vspace{-1pt}\item
    \begin{tabular*}{0.97\textwidth}[t]{l@{\extracolsep{\fill}}r}
      \textbf{#1} & #2 \\
      \textit{\small#3} & \textit{\small #4} \\
    \end{tabular*}\vspace{-5pt}
}

\newcommand{\resumeSubSubheading}[2]{
    \begin{tabular*}{0.97\textwidth}{l@{\extracolsep{\fill}}r}
      \textit{\small#1} & \textit{\small #2} \\
    \end{tabular*}\vspace{-5pt}
}

\newcommand{\resumeSubheadingWithDetails}[6]{
  \vspace{-1pt}\item
    \begin{tabular*}{0.97\textwidth}[t]{l@{\extracolsep{\fill}}r}
      \textbf{#1} & #2 \\
      \textit{\small#3} & \textit{\small#4} \\
    \end{tabular*}
    \vspace{-3pt} % Adjust spacing as needed
    \begin{tabular*}{0.97\textwidth}[t]{l}
      \textit{\small Major: #5 \hspace{20pt} Minor: #6} \\
    \end{tabular*}
    \vspace{-5pt} % Adjust spacing after details
}


\newcommand{\resumeSubItem}[2]{\resumeItem{#1}{#2}\vspace{-4pt}}
\renewcommand{\labelitemii}{$\circ$}
\newcommand{\resumeSubHeadingListStart}{\begin{itemize}[leftmargin=*]}
\newcommand{\resumeSubHeadingListEnd}{\end{itemize}}
\newcommand{\resumeItemListStart}{\begin{itemize}}
\newcommand{\resumeItemListEnd}{\end{itemize}\vspace{-5pt}}


\newcommand{\resumeProjectItem}[4]{
  \item\small{
    \textbf{#1} â€” \textit{#2} \hfill \textit{\small #3}
  }
  \vspace{-4pt}
  \begin{itemize}[leftmargin=1em]
    \item\small{#4 \vspace{-2pt}}
  \end{itemize}
}

%-------------------------
\newcommand{\resumeCertificates}[1]{
  \vspace{-4pt}
  \section*{Certificates}  
  \vspace{-3pt}  
  \begin{tabularx}{\textwidth}{X r} % Two-column layout
    #1
  \end{tabularx}
  \vspace{-5pt} % Reduce bottom space
}

%-------------------------
% Letter section command with full page line (emphasized like original)
\newcommand{\lettersection}[1]{
  \vspace{12pt}
  \noindent{\large\bfseries #1} \textcolor{gray}{\hrulefill} \\
  \vspace{6pt}
}

%-------------------------------------------
%%%%%%  CV STARTS HERE  %%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Load personal information
\input{personal_info}

\begin{document}

% Set language and date based on personal_info.tex
% Expand \mydatelanguage to get its value, then check
\edef\templang{\mydatelanguage}%
\def\tempfinnish{finnish}%
\ifx\templang\tempfinnish
  \selectlanguage{finnish}%
\else
  \selectlanguage{english}%
\fi

% Use manual date if set, otherwise use \today (which respects the language)
% Check if \mydate equals "auto" and replace with \today if so
% IMPORTANT: Language must be selected BEFORE expanding \today
\def\checkdateauto{auto}%
\edef\mydateexpanded{\mydate}%
\ifx\mydateexpanded\checkdateauto
  % Use \protect to prevent expansion until the date is actually used
  \renewcommand{\mydate}{\today}%
\fi

% %----------HEADING-----------------
\begin{center}
  {\Huge \textbf{\myname}} \\
  \vspace{2pt}
  {\Large \mytitle} \\
  \vspace{4pt}
  \href{\mylinkedinurl}{\faLinkedin\ linkedin.com/in/\mylinkedin} \quad
  \href{\mygithuburl}{\faGithub\ github.com/\mygithub} \quad
  \href{\myportfoliourl}{\faFolderOpen\ \myportfolio} \\
  \href{mailto:\myemail}{\myemail} \quad
  \href{tel:\myphone}{\myphone} \\
\end{center}

\vspace{20pt}

% %----------COMPANY DETAILS AND DATE-----------------
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill}}l@{\extracolsep{0pt}}r}
  \begin{minipage}[t]{0.5\textwidth}
    \small
    \textbf{\mycompanyname} \\
    \textcolor{gray}{\mycompanyorg} \\
    \textcolor{gray}{\mycompanyaddress} \\
    \textcolor{gray}{\mycompanycity} \\
  \end{minipage} &
  \begin{minipage}[t]{0.4\textwidth}
    \small
    \flushright
    \textcolor{gray}{\mydate} \\
  \end{minipage} \\
\end{tabular*}

\vspace{16pt}

% %----------LETTER TITLE AND OPENING-----------------
\noindent{\large\bfseries\underline{\mylettertitle}} \\
\vspace{8pt}
\noindent \myletteropening \\
\vspace{12pt}

% %----------LETTER CONTENT-----------------
\lettersection{About Me}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5em}
% EXAMPLE CONTENT - Replace with your actual cover letter content
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecati cupiditate non provident, sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga.

\lettersection{Why \mycompanyorg?}
Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.

\lettersection{Why Me?}
At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio.

\vspace{12pt}

% %----------LETTER CLOSING-----------------
\vspace{8pt}
\noindent \myclosing, \\
\vspace{6pt}
\noindent\textbf{\myname} \\
\vspace{20pt}
\noindent\small\textcolor{gray}{\textit{\myattachedline}}

%-------------------------------------------
\end{document}
