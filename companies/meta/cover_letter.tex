% !TEX program = pdflatex
%-------------------------
% Professional Cover Letter Template in LaTeX
% Author : iggymiggy
% License : MIT
%
% Cover letter template matching CV styling.
% Personal info from personal_info.tex, defaults from base_config.tex,
% company-specific overrides from this file (in company folders).
%------------------------

% Global document settings (paper size, etc.)
% Define \loadfile helper before using it
\newcommand{\loadfile}[2]{%
  \IfFileExists{../../#1}{\input{../../#1}}{%
  \IfFileExists{../#1}{\input{../#1}}{%
  \IfFileExists{#1}{\input{#1}}{#2}}}%
}
\loadfile{document_settings.tex}{}

\documentclass{article}

% Load common package (shared packages, commands, and helpers)
\loadfile{templates/common.sty}{}

% Cover letter-specific packages
\usepackage{etoolbox}
\usepackage[finnish,english]{babel}
\usepackage[utf8]{inputenc}
% Note: glyphtounicode is not needed - \pdfgentounicode=1 in common.sty already handles Unicode encoding

%-------------------------------------------
%%%%%%  COVER LETTER STARTS HERE  %%%%%%%%%%%%%%%%%%%

% Load personal information
% Handles compilation from root, templates/, or companies/company_name/
\loadfile{personal_info.tex}{}

% Load base/default configuration first
% This provides default values for all CV and cover letter fields
\loadfile{templates/base_config.tex}{}

% Load shared company configuration (variables used by both CV and cover letter)
\loadfile{shared.tex}{}

%-----------COMPANY DETAILS (COVER LETTER SPECIFIC)------------
\renewcommand{\companyrecipient}{Meta Recruiting Team}
\renewcommand{\companyname}{Meta}
\renewcommand{\companyaddress}{1 Hacker Way}
\renewcommand{\companycity}{Menlo Park, CA 94025}

%-----------COVER LETTER SETTINGS (COMPANY-SPECIFIC)------------
\renewcommand{\letterdatelanguage}{english}
\renewcommand{\letterdate}{auto}
\renewcommand{\letterclosing}{Sincerely}
\renewcommand{\letteropening}{Dear Hiring Manager,}
\renewcommand{\lettertitle}{Job Application for Senior Software Engineer}
\renewcommand{\letterattachment}{Attached: Curriculum Vitae}

%-----------LETTER BODY (COMPANY-SPECIFIC)------------
% Style 2: Headed sections WITHOUT the horizontal rule line.
% Content is defined directly here - no intermediate variables needed.
\renewcommand{\lettersection}[1]{%
  \vspace{12pt}%
  \noindent{\large\bfseries #1} \\%
  \vspace{6pt}%
}

\providecommand{\letterbody}{}%
\renewcommand{\letterbody}{%
  \lettersection{About Me}
  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.

  \lettersection{Why \companyname?}
  Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.

  \lettersection{Why Me?}
  At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.
}

\begin{document}

% Set date language (from base_config.tex or this file override)
\edef\templang{\letterdatelanguage}%
\def\tempfinnish{finnish}%
\ifx\templang\tempfinnish
  \selectlanguage{finnish}%
\else
  \selectlanguage{english}%
\fi

% Set date (auto uses \today, respects language setting)
\def\checkdateauto{auto}%
\edef\letterdateexpanded{\letterdate}%
\ifx\letterdateexpanded\checkdateauto
  \renewcommand{\letterdate}{\today}%
\fi

%-----------HEADING------------
\begin{center}
  {\Huge \textbf{\myname}} \\
  \vspace{2pt}
  {\Large \cvtitle} \\
  \vspace{4pt}
  \href{\mylinkedinurl}{\faLinkedin\ linkedin.com/in/\mylinkedin} \quad
  \href{\mygithuburl}{\faGithub\ github.com/\mygithub} \quad
  \href{\myportfoliourl}{\faFolderOpen\ \myportfolio} \\
  \href{mailto:\myemail}{\myemail} \quad
  \href{tel:\myphone}{\myphone} \\
\end{center}

\vspace{20pt}

% %----------COMPANY DETAILS AND DATE-----------------
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill}}l@{\extracolsep{0pt}}r}
  \begin{minipage}[t]{0.52\textwidth}
    \small
    \raggedright
    \textbf{\companyrecipient} \\
    \textcolor{gray}{\companyname} \\
    \textcolor{gray}{\companyaddress} \\
    \textcolor{gray}{\companycity} \\
  \end{minipage} &
  \begin{minipage}[t]{0.38\textwidth}
    \small
    \raggedleft
    \textcolor{gray}{\letterdate} \\
  \end{minipage} \\
\end{tabular*}

\vspace{36pt}

%-----------LETTER TITLE AND OPENING------------
\noindent{\large\bfseries\underline{\lettertitle}} \\
\vspace{8pt}
\noindent \letteropening \\
\vspace{12pt}

%-----------LETTER CONTENT------------
% Content from base_config.tex or this file override
% Company configs can override \letterbody to reorder/add/remove sections.
\letterbody

\vspace{12pt}

%-----------LETTER CLOSING------------
\vspace{8pt}
\noindent \letterclosing, \\
\vspace{6pt}
\noindent\textbf{\myname} \\
\vspace{20pt}
\noindent\small\textcolor{gray}{\textit{\letterattachment}}

%-------------------------------------------
\end{document}
